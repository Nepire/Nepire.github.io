---
layout: post
title: "黑盾杯记录"
date:   2019-09-15 19:00:00
categories: WriteUp
tags: WriteUp 黑盾
---

* content
{:toc}
第一次打黑盾杯，拿了特等，web带哥太强了，这里记录下几题二进制的题


# choice
![图片](https://uploader.shimo.im/f/OaPViiarV5o15ScB.png!thumbnail)

![图片](https://uploader.shimo.im/f/6SeyJzeitMsXO737.png!thumbnail)
LIBC2.23 32位开了NX，感觉挺简单的
ida打开看一下
很容易就发现有一个offbyone 来修改size来造成栈溢出
![图片](https://uploader.shimo.im/f/IfEs0JHG98cJxvW6.png!thumbnail)
![图片](https://uploader.shimo.im/f/JYJUj37x3RM3DwJC.png!thumbnail)
然后我们在后面看到用这个全局size来readbuf的函数
![图片](https://uploader.shimo.im/f/N77yD41yOnYJKzNy.png!thumbnail)
偷偷吐槽（垃圾题目，为出题而出题）
这里就直接ret2libc了，也不需要什么技巧
![图片](https://uploader.shimo.im/f/DjiJvPx0lxQB29hD.png!thumbnail)


# easypwn
吐槽一下，比赛完全不知道这还是原题，赛后和Mais的师傅聊的时候才知道这是他们Rctf2015的原题，payload都不用改的那种，我就只能呵呵了（再吐槽****）
![图片](https://uploader.shimo.im/f/084DVLo7zKsgjuqf.png!thumbnail)
![图片](https://uploader.shimo.im/f/DuTis7Nw77wc9EFp.png!thumbnail)
很常规的栈溢出模板，但这里strcpy会产生\0截断，而且栈上返回地址后面是0x18的填充字符，需要找pop4的gadget然后就算正常ret2libc了
![图片](https://uploader.shimo.im/f/InbNBZV8gvwx5Ipw.png!thumbnail)


# Reverse02
这题没得辩，是我脑子坏了，把最后一个花括号也异或了
我们看一下程序
![图片](https://uploader.shimo.im/f/yJHX8yFxo1QZArDd.png!thumbnail)
看似Creakme，实际根本点不动，要么出题人脑抽了，要么主办方改题没删好
我们ida静态分析一下
![图片](https://uploader.shimo.im/f/WoX5eLhbNAMdi1rc.png!thumbnail)
进来就看到这个函数，实际上也就这个函数异或一下就出flag了，可能是最近想问题自己会在那绕，我就没那么直接就去解了
查看了下调用
发现前面要过个check才能进这个函数
![图片](https://uploader.shimo.im/f/Gg3ZmwHyUDMFGpD8.png!thumbnail)
看一下条件
![图片](https://uploader.shimo.im/f/JQrxvc8WC1E9KBA2.png!thumbnail)
![图片](https://uploader.shimo.im/f/rrj7LfqmPuIhe0Oq.png!thumbnail)
我们很容易就能知道这个this是我们输入的，简单处理下反编译结果
![图片](https://uploader.shimo.im/f/fP7ZUPlORCwyySxH.png!thumbnail)
![图片](https://uploader.shimo.im/f/O80HFwOal48E4JS7.png!thumbnail)
然后再把Rkey提取出来
![图片](https://uploader.shimo.im/f/C7C5EuZPh38sw1HI.png!thumbnail)
我们大致能想到他原本可能是想让我们先逆出注册码然后输入验证码调用输出flag的函数，然后他这个比较尴尬的是，前面这一堆想要你逆出注册码的东西完全没用，直接逆输出flag的函数就能得到flag
整理下这个程序的代码

![图片](https://uploader.shimo.im/f/GFqYrVHvyxcGfeCh.png!thumbnail)
然后最简单的做法就是
![图片](https://uploader.shimo.im/f/q10PpN84nHwH9uDt.png!thumbnail)
把Dst改成数组就能看出来了
```
flag{VEg46R4m04f7607c61e732732a0d4f737f34d674f}
```

